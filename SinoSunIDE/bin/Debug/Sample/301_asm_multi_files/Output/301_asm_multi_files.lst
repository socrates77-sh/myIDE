gplink-1.3.1 (Jul  9 2013)
Listing File Generated: 2013-9-26  14:43:04
 
 
Address  Value    Disassembly              Source
-------  -----    -----------              ------
                                           
                                           
                                           #include "mc30p011.inc"
                                                   LIST
                                           ;MC30P01A.INC  Standard Header File, Version 1.00 by Sinomcu
                                                   NOLIST
                                           #include "var.inc"
                                           
                                           ;------------------------------------------------
                                           ;定义一个头文件用来存放程序中的变量和位定义，所有变量均为全局变量
                                           ;
                                           ;-------------------------------------------------
                                           
                                           #define    RAM_COUNT    48    ;48个RAM
                                           #define    FIR_RAM_ADDR    0x10    ;RAM首地址
                                           
                                           #define    MAX_DIS_DATA    18
                                           
                                           #define    RAM_E    0x00        ;RAM错误报E0
                                           ;***************特殊RAM***********
                                           R0    equ    0x07
                                           DDR0    equ    0x45
                                           DDR1    equ    0x46
                                           
                                           #define    r0    R0
                                           #define    IO_TM1628_STB    P0,0
                                           #define    IO_TM1628_CLK    P0,1
                                           #define    IO_TM1628_DATA    P0,2
                                           #define    IO_TM1628_DDR    DDR0,2
                                           ;*************ram****************
                                           cblock    0x10
                                           acc_temp
                                           status_temp
                                           flag_work0
                                           flag_work1
                                           flag_work2
                                           counter
                                           endc
                                           ;***************end ram*************
                                           #define         timer_10ms      flag_work0,0
                                           #define         timer_100ms     flag_work0,1
                                           
                                           
                                           #define         led0            flag_work1,0
                                           #define         led1            flag_work1,1
                                           
                                           
                                           
                                           ;---------全局标号，外部标号声明--------------------------------
                                                   extern  reset
                                                   extern  loop
                                                   
                                                   global  fn_initial
                                                   global  fn_keyscan
                                           
                                           code_fun01      code  ;定义一个代码地址段，但不指定起始地址        
                                                  
                                           fn_initial:
000016   0bff     movai   0xff                     movai   0xff
000017   1585     movra   0x5                      movra   P0
000018   1586     movra   0x6                      movra   P1
000019   1dc5     dw      0x1dc5                   clrr    DDR0
00001a   1dc6     dw      0x1dc6                   clrr    DDR1
00001b   201f     call    0x1f                     call    fn_clear_ram
00001c   3813     bset    0x13, 0                  bset    led0
00001d   3893     bset    0x13, 0x1                bset    led1
00001e   000c     return                           return      
                                           
                                                   
                                           fn_clear_ram:
00001f   0b30     movai   0x30                 movai       48 ;0x10--0x3f
000020   1587     movra   0x7                  movra       GPR
000021   0b10     movai   0x10                 movai       0x10 ;first ram addr
000022   1584     movra   0x4                  movra       FSR
                                           lab_clear_loop:    
000023   1d80     clrr    0                    clrr        INDF
000024   1984     incr    0x4                  INCR        FSR
000025   1a87     djzr    0x7                  DJZR        GPR
000026   2823     goto    0x23                 goto        lab_clear_loop          
000027   000c     return                       return 
                                           
                                           fn_keyscan:
000028   0baa     movai   0xaa                 movai       0xaa
000029   0000     nop                          nop
00002a   0000     nop                          nop ;....
                                               
00002b   000c     return                       return
                                               
                                               end
                                               
                                                   
                                           #include "mc30p011.inc"
                                                   LIST
                                           ;MC30P01A.INC  Standard Header File, Version 1.00 by Sinomcu
                                                   NOLIST
                                           #include "var.inc"
                                           
                                           ;------------------------------------------------
                                           ;定义一个头文件用来存放程序中的变量和位定义，所有变量均为全局变量
                                           ;
                                           ;-------------------------------------------------
                                           
                                           #define    RAM_COUNT    48    ;48个RAM
                                           #define    FIR_RAM_ADDR    0x10    ;RAM首地址
                                           
                                           #define    MAX_DIS_DATA    18
                                           
                                           #define    RAM_E    0x00        ;RAM错误报E0
                                           ;***************特殊RAM***********
                                           R0    equ    0x07
                                           DDR0    equ    0x45
                                           DDR1    equ    0x46
                                           
                                           #define    r0    R0
                                           #define    IO_TM1628_STB    P0,0
                                           #define    IO_TM1628_CLK    P0,1
                                           #define    IO_TM1628_DATA    P0,2
                                           #define    IO_TM1628_DDR    DDR0,2
                                           ;*************ram****************
                                           cblock    0x10
                                           acc_temp
                                           status_temp
                                           flag_work0
                                           flag_work1
                                           flag_work2
                                           counter
                                           endc
                                           ;***************end ram*************
                                           #define         timer_10ms      flag_work0,0
                                           #define         timer_100ms     flag_work0,1
                                           
                                           
                                           #define         led0            flag_work1,0
                                           #define         led1            flag_work1,1
                                           
                                           
                                                   extern  fn_initial
                                                   extern  fn_keyscan
                                                   extern  fn_display
                                                   extern  fn_otherthing
                                           
                                           code_0x3ff      code    0x3ff ;定义一个代码段，起始地址为0x3ff
0003ff   282c     goto    0x2c                     goto    reset
                                           code_0x00       code    0x00    ;定义一个代码段，起始地址为0x00
000000   282c     goto    0x2c                     goto    reset
                                           
                                                   
                                           code_reset      code    ; 定义一个代码段，不固定起始地址
                                           reset:
00002c   3f8e     bclr    0xe, 0x7              bclr       GIE 
00002d   2016     call    0x16                  call       fn_initial
00002e   1dc1     dw      0x1dc1                clrr       T0CR
00002f   380e     bset    0xe, 0                bset       T0IE ;enable timer0 interrupt  
000030   3b8e     bset    0xe, 0x7              bset       GIE
                                           
                                           loop:
000031   2028     call    0x28                     call    fn_keyscan
000032   2035     call    0x35                     call    fn_display
000033   203b     call    0x3b                     call    fn_otherthing
000034   2831     goto    0x31                     goto    loop
                                              
                                                   end     
                                           
                                               end
                                                           
                                           
                                           #include "mc30p011.inc"
                                                   LIST
                                           ;MC30P01A.INC  Standard Header File, Version 1.00 by Sinomcu
                                                   NOLIST
                                           #include "var.inc"
                                           
                                           ;------------------------------------------------
                                           ;定义一个头文件用来存放程序中的变量和位定义，所有变量均为全局变量
                                           ;
                                           ;-------------------------------------------------
                                           
                                           #define    RAM_COUNT    48    ;48个RAM
                                           #define    FIR_RAM_ADDR    0x10    ;RAM首地址
                                           
                                           #define    MAX_DIS_DATA    18
                                           
                                           #define    RAM_E    0x00        ;RAM错误报E0
                                           ;***************特殊RAM***********
                                           R0    equ    0x07
                                           DDR0    equ    0x45
                                           DDR1    equ    0x46
                                           
                                           #define    r0    R0
                                           #define    IO_TM1628_STB    P0,0
                                           #define    IO_TM1628_CLK    P0,1
                                           #define    IO_TM1628_DATA    P0,2
                                           #define    IO_TM1628_DDR    DDR0,2
                                           ;*************ram****************
                                           cblock    0x10
                                           acc_temp
                                           status_temp
                                           flag_work0
                                           flag_work1
                                           flag_work2
                                           counter
                                           endc
                                           ;***************end ram*************
                                           #define         timer_10ms      flag_work0,0
                                           #define         timer_100ms     flag_work0,1
                                           
                                           
                                           #define         led0            flag_work1,0
                                           #define         led1            flag_work1,1
                                           
                                           
                                           
                                           ;----------------------------------
                                           
                                           code_errupt	code	0x8
                                           interrupt_code:
000008   1590     movra   0x10                    movra    acc_temp
000009   1103     swapar  0x3                    swapar    STATUS
00000a   1591     movra   0x11                    movra    status_temp
00000b   340e     jbclr   0xe, 0                  jbclr   T0IE      
00000c   300f     jbset   0xf, 0                  jbset   T0IF 
00000d   2811     goto    0x11                    goto    exit_interrupt
00000e   3c0f     bclr    0xf, 0                   bclr    T0IF
00000f   3812     bset    0x12, 0                  bset     timer_10ms;
000010   3c92     bclr    0x12, 0x1                bclr     timer_100ms
                                                  
                                           exit_interrupt:
000011   1111     swapar  0x11                 swapar    status_temp
000012   1583     movra   0x3                  movra     STATUS
000013   1190     swapr   0x10                 swapr     acc_temp
000014   1110     swapar  0x10                 swapar    acc_temp
000015   000d     retie                        retie   
                                           
                                           ;code_interrupt	code
                                                   end    
                                           
                                           
                                           #include        "mc30p011.inc"
                                                   LIST
                                           ;MC30P01A.INC  Standard Header File, Version 1.00 by Sinomcu
                                                   NOLIST
                                           #include        "var.inc"
                                           
                                           ;------------------------------------------------
                                           ;定义一个头文件用来存放程序中的变量和位定义，所有变量均为全局变量
                                           ;
                                           ;-------------------------------------------------
                                           
                                           #define    RAM_COUNT    48    ;48个RAM
                                           #define    FIR_RAM_ADDR    0x10    ;RAM首地址
                                           
                                           #define    MAX_DIS_DATA    18
                                           
                                           #define    RAM_E    0x00        ;RAM错误报E0
                                           ;***************特殊RAM***********
                                           R0    equ    0x07
                                           DDR0    equ    0x45
                                           DDR1    equ    0x46
                                           
                                           #define    r0    R0
                                           #define    IO_TM1628_STB    P0,0
                                           #define    IO_TM1628_CLK    P0,1
                                           #define    IO_TM1628_DATA    P0,2
                                           #define    IO_TM1628_DDR    DDR0,2
                                           ;*************ram****************
                                           cblock    0x10
                                           acc_temp
                                           status_temp
                                           flag_work0
                                           flag_work1
                                           flag_work2
                                           counter
                                           endc
                                           ;***************end ram*************
                                           #define         timer_10ms      flag_work0,0
                                           #define         timer_100ms     flag_work0,1
                                           
                                           
                                           #define         led0            flag_work1,0
                                           #define         led1            flag_work1,1
                                           
                                           
                                                   global  fn_display
                                                   global  fn_otherthing
                                                   
                                                   extern  fn_keyscan
                                                   
                                                   
                                           code_fun02      code  ; 定义一个代码段，不指定程序起始地址
                                                   
                                           fn_display:
000035   3c13     bclr    0x13, 0                  bclr    led0
000036   2028     call    0x28                     call    fn_keyscan
000037   0000     nop                              NOP
000038   0000     nop                              nop 
000039   0000     nop                              nop ;....
00003a   000c     return                           return
                                                   
                                           fn_otherthing:
00003b   0000     nop                              nop
00003c   0000     nop                              nop
00003d   000c     return                           return     
                                                
                                                end   


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XX-------------- XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXX----
07C0 : ---------------- ---------------- ---------------- --------------XX

All other memory blocks unused.

Program Memory Words Used:    56

