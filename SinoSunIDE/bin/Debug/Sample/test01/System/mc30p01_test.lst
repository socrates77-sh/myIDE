gpasm-0.9.0 (Mar 19 2013)    G:\Emulator\IDE\SinoSunIDE\SinoSunIDE\bin\Debug\Sample\test01\mc30p01_test.asm2013-5-29  16:18:22          PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 #include mc30p01a.inc
                      00001         LIST
                      00002 ;MC30P01A.INC  Standard Header File, Version 1.00 by Sinomcu
                      00182         LIST
                      00002 
                      00003 
                      00004 
                      00005 cblock 0x10 
                      00006 acc_temp
                      00007 status_temp
                      00008 r1
                      00009 r2
                      00010 work_flag1
                      00011 work_flag2
                      00012 error_flag
                      00013 
                      00014 time_125us
                      00015 time_1ms
                      00016 time_10ms
                      00017 time_100ms
                      00018 time_1s
                      00019 time_1min
                      00020 time_1hour
                      00021 endc
                      00022 
                      00023 #define r10 r1,0
                      00024 #define r11 r1,1
                      00025 
                      00026 #define sks 0x20a5
                      00027 
                      00028 ;extern akbk;
0000                  00029 .code
                      00030     org 3ffh
03FF   1D8E           00031     clrr INTE ; disable all interrupt
                      00032               
                      00033     org 00h ;ksks
0000   2800           00034     goto lab_start
0001   0BA5           00035     movai low(sks)
0002   0B20           00036     movai high(sks)
                      00037 
                      00038     ;movar akbk
                      00039    
                      00040     org 08h
0008                  00041 fn_interrupt_sub:
0008   1590           00042     movra    acc_temp
0009   1603           00043     movar    STATUS
000A   1591           00044     movra    status_temp
                      00045 ;*******判断是哪个中断*****
000B                  00046 start_just_int:
                      00047  ;int0
000B   310F           00048     jbset    INT0IF
000C   2800           00049     goto    exit_interrupt
000D   3D0F           00050     bclr    INT0IF
000E   0000           00051  nop
000F   0000           00052  nop
0010   0000           00053  nop
0011   0000           00054  nop
0012   0000           00055  nop
0013   0000           00056  NOP
0014   0000           00057  nop
                      00058  
                      00059  
0015                  00060 exit_interrupt:
0015   1611           00061     movar    status_temp
0016   1583           00062     movra    STATUS
0017   1610           00063     movar    acc_temp
0018   000D           00064     retie
                      00065 ;;*******软中断代码***********
                      00066 ;soft_interrupt:
                      00067 ;    movar    status_temp
                      00068 ;    movra    STATUS
                      00069 ;    movar    acc_temp
                      00070 ;    retie
                      00071 ; rti  
                      00072 
                      00073 
                      00074   
0019                  00075 lab_start:
                      00076     ;fill    0x0000,5
                      00077     
                      00078     ; dt "abcde"
0019   0B06           00079     movai   4|6;
001A   0B09           00080     movai   '\t'
001B   15C5           00081     movra   P5IOC ;p0 output
001C   0BFF           00082     movai   0xFF
001D   15C6           00083     movra   P6IOC ;p1 input
001E   3C0D           00084     bclr    PHCON,0    ;开P10上拉    bclr    INT0M
001F   0BAA           00085     movai       0xaa
0020   1592           00086     movra      r1 
0021   3812           00087     bset      r10
0022   0000           00088     nop
0023   0000           00089     nop
0024   0000           00090     nop
                      00091     
                      00092     
0025   0B12           00093       movai 0x12
0026   1584           00094       movra FSR
0027   0B0A           00095       movai 0x0a
0028   1580           00096       movra INDF
0029   1980           00097       incr INDF
002A   0B20           00098       movai 0x20
002B   1584           00099       movra FSR
                      00100       ;incr INDF
                      00101       ;movai 0x34
                      00102       ;movra FSR
                      00103       ;incr INDF
                      00104       ;incr INDF
                      00105       
002C   0B10           00106       movai 0x10
002D   15A0           00107       movra 020h
002E   3CA0           00108       bclr  020h,1
002F   0000           00109       nop
0030   0000           00110       NOP
0031   30A0           00111       jbset 020h,1
0032   0000           00112       nop 
0033   383F           00113       bset  0x3f,0
0034   34A0           00114       jbclr 020h,1
0035   0000           00115       nop 
0036   0000           00116       nop
                      00117       
                      00118       
0037   3B8E           00119       bset GIE
                      00120       
0038                  00121 loop: 
0038   0B55           00122     movai 0x55
0039   1590           00123     movra 0x10
003A   1990           00124     incr  0x10
                      00125  ;   goto $-1
003B   0000           00126         NOP
003C   0000           00127         nop
003D   2000           00128     call int0_cfg_l
                      00129     ;sleep;    
003E   0BFE           00130     movai 0xfe
003F   1585           00131     movra   P0
0040   0000           00132     nop
0041   2000           00133     call fun001
0042   0000           00134     nop
0043   0B00           00135     movai 0x00
0044   1585           00136     movra P0
0045   0000           00137     nop
0046   0000           00138     nop
0047   2000           00139     call int0_cfg_h
                      00140     ;sleep
                      00141     ;movai 0xfe
                      00142     ;movra   P0
                      00143     ;nop
                      00144     ;nop
                      00145     ;movai 0x00
                      00146     ;movra P0
                      00147     ;nop
                      00148     ;nop
0048   2800           00149     goto loop
                      00150     
0049                  00151 fun001:
0049   0000           00152     nop
004A   2000           00153     call fun002
004B   0000           00154     nop
004C   000C           00155     return
004D                  00156 fun002:
004D   0000           00157     nop
004E   2000           00158     call fun003
004F   0000           00159     nop
0050   000C           00160     return
0051                  00161 fun003:
0051   0000           00162     nop
0052   000C           00163     return  
                      00164 
                      00165 
                      00166     
                      00167 ;*****int0 cfg************************
                      00168 ;*****下降沿触发**********************
0053                  00169 int0_cfg_l:    
0053   3846           00170     bset    DDR1,0    ;P10输入    
0054   3C0D           00171     bclr    PHCON,0    ;开P10上拉    
0055   3F41           00172     bclr    INT0M    
0056   3B08           00173     bset    EIS    
0057   390E           00174     bset    INT0IE    ;开中断    
0058   3F88           00175     bclr    WDTEN    
                      00176     ;sleep    
0059   000C           00177     return;
                      00178 ;**************************************
005A                  00179 int0_cfg_h:    
005A   3846           00180     bset    DDR1,0    ;P10输入    
005B   3C0D           00181     bclr    PHCON,0    ;开P10上拉    
005C   3B41           00182     bset    INT0M    
005D   3B08           00183     bset    EIS    
005E   390E           00184     bset    INT0IE    ;开中断    
005F   3F88           00185     bclr    WDTEN    
                      00186     ;sleep    
0060   000C           00187     return;
                      00188     
                      00189     end
gpasm-0.9.0 (Mar 19 2013)    G:\Emulator\IDE\SinoSunIDE\SinoSunIDE\bin\Debug\Sample\test01\mc30p01_test.asm2013-5-29  16:18:22          PAGE  2


SYMBOL TABLE
  LABEL                             VALUE

.code                             00000000
DDR0                              00000045
DDR1                              00000046
FSR                               00000004
GPR                               00000007
INDF                              00000000
INTECON                           0000000E
INTEFLAG                          0000000F
KBIM                              00000009
MCR                               00000008
ODCON                             0000000C
P0                                00000005
P1                                00000006
P5IOC                             00000045
P6IOC                             00000046
PCL                               00000002
PCLATH                            0000000A
PDCON                             0000000B
PHCON                             0000000D
PR0                               00000000
PR1                               00000001
PR2                               00000002
PTA                               00000003
STATUS                            00000003
T0CNT                             00000001
T0CR                              00000041
T0CS                              00000005
T0SE                              00000004
_BOR_15                           00003FF8
_BOR_18                           00003FF9
_BOR_20                           00003FFA
_BOR_22                           00003FFB
_BOR_24                           00003FFC
_BOR_26                           00003FFD
_BOR_36                           00003FFF
_CONFIG1                          00002000
_CONFIG2                          00002001
_CP_OFF                           00003FFF
_CP_ON                            00001FFF
_FCPU_2T                          00003F7F
_FCPU_4T                          00003FFF
_FOSC_1M                          00003FCF
_FOSC_2M                          00003FDF
_FOSC_32K                         00003F9F
_FOSC_455K                        00003FAF
_FOSC_4M                          00003FEF
_FOSC_500K                        00003FBF
_FOSC_62P5K                       00003F8F
_FOSC_8M                          00003FFF
_MCLR_OFF                         00003FF7
_MCLR_ON                          00003FFF
_MCU_EMC                          00003BFF
_MCU_FEL                          00003FFF
_OSCM_HS                          00003FFF
_OSCM_IRC                         000037FF
_OSCM_LP                          00003FFF
_RDPORT_PIN                       00003FFF
_RDPORT_REG                       00003EFF
_ROTP_100N                        00001FFF
_ROTP_200N                        00002FFF
_ROTP_300N                        00000FFF
_ROTP_HALFCPU                     00003FFF
_SMT_OFF                          00003DFF
_SMT_ON                           00003EFF
_TWDT_18_18                       00003FFF
_TWDT_288_288                     00003DFF
_TWDT_4P5_4P5                     00003EFF
_TWDT_72_72                       00003CFF
_TWDT_P140_18                     00003BFF
_TWDT_P140_288                    000039FF
_TWDT_P140_4P5                    00003AFF
_TWDT_P140_72                     000038FF
_WDT_OFF                          000037FF
_WDT_ON                           00003FFF
__30P01A                          00000001
acc_temp                          00000010
error_flag                        00000016
exit_interrupt                    00000015
fn_interrupt_sub                  00000008
fun001                            00000049
fun002                            0000004D
fun003                            00000051
int0_cfg_h                        0000005A
int0_cfg_l                        00000053
lab_start                         00000019
loop                              00000038
r1                                00000012
r2                                00000013
start_just_int                    0000000B
status_temp                       00000011
time_100ms                        0000001A
time_10ms                         00000019
time_125us                        00000017
time_1hour                        0000001D
time_1min                         0000001C
time_1ms                          00000018
time_1s                           0000001B
work_flag1                        00000014
work_flag2                        00000015
C                                 STATUS,0
DC                                STATUS,1
EIS                               MCR,6
GIE                               INTECON,7
GPR0                              STATUS,5
GPR1                              STATUS,6
INT0IE                            INTECON,2
INT0IF                            INTF,2
INT0M                             T0CR,6
INTE                              INTECON
INTF                              INTEFLAG
KBIE                              INTECON,1
KBIF                              INTF,1
PD                                STATUS,3
RST                               STATUS,7
T0IE                              INTECON,0
T0IF                              INTF,0
TO                                STATUS,4
WDTEN                             MCR,7
Z                                 STATUS,2
r10                               r1,0
r11                               r1,1
sks                               0x20a5

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

