gplink-0.9.0 (Mar 19 2013)
Listing File Generated: 2013-3-29  18:06:13
 
 
Address  Value    Disassembly              Source
-------  -----    -----------              ------
                                           #include mc33p716.inc
                                           ;==========================================================================
                                           
                                           ;W                            EQU     H'0000'
                                           ;F                            EQU     H'0001'
                                           
                                           ;----- Register Files------------------------------------------------------
                                           cblock	0x1B0
                                           INDF0			
                                           INDF1			
                                           INDF2			
                                           HIBYTE			
                                           FSR0			
                                           FSR1			
                                           PCL			
                                           PFALG			
                                           ;----0x1B8
                                           MCR			
                                           INDF3			
                                           INTE0			
                                           INTF0			
                                           OSCM	;INVALID_ADDR0		
                                           INVALID_ADDR1		
                                           INVALID_ADDR2		
                                           INVALID_ADDR3		
                                           ;----0x1C0
                                           P0			
                                           DDR0                    
                                           PUP0           
                                           PUS0
                                           PDP0
                                           PDS0
                                           DKWP0
                                           INVALID_ADDR_P0
                                           ;ANSEL
                                           ;P1                      
                                           ;DDR1                    
                                           ;PUP1                    
                                           ;KBIM           
                                           ;-----0x1C8
                                           P1			
                                           DDR1                        
                                           PUP1           
                                           PUS1
                                           PDP1
                                           PDS1
                                           DKWP1
                                           INVALID_ADDR_P1
                                           ;----0x1D0
                                           P2			
                                           DDR2                    
                                           PUP2           
                                           PUS2
                                           PDP2
                                           PDS2
                                           DKWP2
                                           INVALID_ADDR_P2
                                           ;----0x1D8
                                           TACR
                                           TALOADH
                                           TALOADL
                                           TALATRH
                                           TALATRL
                                           TALATFH
                                           TALATFL
                                           INVALID_ADDR_TA
                                           ;-----0x1E0
                                           TBCR
                                           TBDATA
                                           TBLOAD
                                           INVALID_ADDR_TB0
                                           OPCR0
                                           OPCR1
                                           DKW
                                           INVALID_ADDR_TB1
                                           ;----0x1E8
                                           ADCR0
                                           ADCR1
                                           ADRH
                                           ADRL
                                           TMPCR
                                           INVALID_ADDR_AD0      
                                           INVALID_ADDR_AD1        
                                           INVALID_ADDR_AD2
                                           endc
                                           ;------------------------------------------------
                                           #define		STATUS		PFALG
                                           #define		INDF		INDF0
                                           #define		FSR		FSR0
                                           #define		P0HCON		PUP0
                                           #define		P1HCON		PUP1
                                           #define		INTECON		INTE0
                                           #define		INTEFLAG	INTF0	
                                           
                                           ;----- STATUS Bits --------------------------
                                           #define	Z	STATUS,2
                                           #define	DC	STATUS,1
                                           #define	C	STATUS,0
                                           
                                           ;----- MCR Bits --------------------------
                                           #define	GIE	MCR,7
                                           #define	T0	MCR,5
                                           #define	PD	MCR,4
                                           #define	MINT11	MCR,3
                                           #define	MINT10	MCR,2
                                           #define	MINT01	MCR,1
                                           #define	MINT00	MCR,0
                                           ;-----  P2HCON Bits -----------------------
                                           #define	P20PH	P2HCON,0
                                           #define	P21PH	P2HCON,1
                                           #define	P22PH	P2HCON,2
                                           #define	P23PH	P2HCON,3
                                           #define	P24PH	P2HCON,4
                                           #define	P25PH	P2HCON,5
                                           #define	P26PH	P2HCON,6
                                           #define	P27PH	P2HCON,7
                                           ;----- INTECON Bits --------------------------
                                           #define	INTE	INTECON
                                           #define	KBIE	INTECON,7
                                           #define	ADIE	INTECON,6
                                           #define	LVDIE	INTECON,5
                                           
                                           #define	INT1IE	INTECON,3
                                           #define	INT0IE	INTECON,2
                                           
                                           ;----- INTEFLAG Bits --------------------------
                                           #define	INTF	INTEFLAG
                                           #define	KBIF	INTF,7
                                           #define	ADIF	INTF,6
                                           #define	LVDIF	INTF,5
                                           
                                           #define	INT1IF	INTF,3
                                           #define	INT0IF	INTF,2
                                           ;---- ADCR0 Bits -----------------
                                           #define	   ADCKS_8	0<<1	;Fsys/8
                                           #define	   ADCKS_4 	1<<1	;Fsys/4
                                           #define	   ADCKS_2 	2<<1	;Fsys/2
                                           #define	   ADCKS_1 	3<<1	;Fsys/1
                                           #define	   ADCHS_0	0<<4	;AN0
                                           #define	   ADCHS_1	1<<4	;AN1
                                           #define	   ADCHS_2	2<<4	;AN2
                                           #define	   ADCHS_3	3<<4	;AN3
                                           #define	   ADCHS_4	4<<4	;AN4
                                           #define	   ADCHS_5	5<<4	;AN5
                                           #define	   ADCHS_6	6<<4	;AN6
                                           #define	   ADCHS_7	7<<4	;AN7
                                           #define	   ADCHS_8	8<<4	;AN8
                                           #define	   ADCHS_9	9<<4	;AN9
                                           #define	   ADCHS_VDD	0x0d<<4	;VDD
                                           #define	   ADCHS_VDD4	0x0e<<4	;VDD/4
                                           #define	   ADCHS_VDD2	0x0f<<4	;VDD/2
                                           #define ADEN	ADCR0,0
                                           #define	ADEOC	ADCR0,1
                                           ;----- T0CR  Bits ----------------
                                           #define	T0CR	TACR
                                           #define	T0IF	T0CR,7
                                           #define	T0XF	T0CR,6
                                           #define	T0IE	T0CR,5
                                           #define	PR0_1	0<<3
                                           #define	PR0_2	1<<3
                                           #define	PR0_4	2<<3
                                           #define	PR0_8	3<<3
                                           #define	TC0EN	T0CR,2
                                           ;----- T1CR  Bits ----------------
                                           #define	T1CR	TBCR
                                           #define	T1IF	T1CR,7
                                           #define	T1XF	T1CR,6
                                           #define	T1IE	T1CR,5
                                           #define	PR1_1	0<<3
                                           #define	PR1_2	1<<3
                                           #define	PR1_4	2<<3
                                           #define	PR1_8	3<<3
                                           #define	TC1EN	T1CR,2
                                           ;----- OSCM  Bits ----------------
                                           #define	CLKS	OSCM,2
                                           #define	LFEN	OSCM,1
                                           #define	HFEN	OSCM,0
                                           ;
                                           ;;-----  POWCR Bits -------
                                           ;#define LDOEN	POWCR,7
                                           ;#define	ENB	POWCR,6
                                           ;;-----  LVDCR Bits -------
                                           ;#define LVD	PLVDCR,7
                                           ;#define	LVDS	PLVDCR,6
                                           ;***********DDR1 DDR2 **********
                                           #define	DDR10	DDR1,0
                                           #define	DDR11	DDR1,1
                                           #define	DDR12	DDR1,2
                                           #define	DDR13	DDR1,3
                                           
                                           #define	DDR20	DDR2,0
                                           #define	DDR21	DDR2,1
                                           #define	DDR22	DDR2,2
                                           #define	DDR23	DDR2,3
                                           #define	DDR24	DDR2,4
                                           #define	DDR25	DDR2,5
                                           #define	DDR26	DDR2,6
                                           #define	DDR27	DDR2,7
                                           ;******************************
                                           ;----DKW----
                                           #define	DKWE	DKW,7
                                           #define	IROS	DKW,6
                                           #define	IROT	DKW,5
                                           #define	WSEL_32		00
                                           #define	WSEL_64		1<<3
                                           #define	WSEL_96		2<<3
                                           #define	WSEL_128 	3<<3
                                           #define	ISEL_0_7	0
                                           #define	ISEL_1_7	1
                                           #define	ISEL_2_7	2
                                           #define	ISEL_3_7	3
                                           #define	ISEL_4_7	4
                                           #define	ISEL_5_7	5
                                           #define	ISEL_6_7	6
                                           #define	ISEL_7_7	7
                                           
                                           
                                           
                                           ;*************ram****************
                                           ;#define	r0	0x1af
                                           ;#define	r1	0x1ae	
                                           ;#define	r2	0x1ad
                                           cblock 0x00
                                           r0
                                           r1
                                           r2
                                           r3
                                           acc_temp
                                           status_temp
                                           flag
                                           
                                           
                                           
                                           endc
                                           
                                           #define  stop_enable         flag,0
                                           #define  clk_enable          flag,1
                                           #define  key                 P2,1
                                           
                                           ;***********************
                                           #define R0 r0
                                           #define OUT_IR	P1,7
                                           
                                           #define    RAM_COUNT    0xff    ;48个RAM
                                           #define    FIR_RAM_ADDR    0x00    ;RAM首地址
                                           ;#undefine  INDF
                                           ;#define    INDF		INDF3
                                           #define    MAX_DIS_DATA    18
                                           
                                           
                                           
                                           
                                                       org 0x0
000000   a022     goto    0x22                     goto    main
                                           
                                                   org 0x8        
                                           start_just_int:
000008   fbd8     jbclr   0x1d8, 0x5               jbclr    T0IE
000009   efd8     jbset   0x1d8, 0x7               jbset    T0IF
00000a   a00c     goto    0xc                      goto     lab_if_timer1_int
                                           ;----timer0-----------------------
00000b   dfd8     bclr    0x1d8, 0x7               bclr    T0IF
                                                   
                                           
                                           ;---------------------------------
                                           lab_if_timer1_int:        
00000c   fbe0     jbclr   0x1e0, 0x5               jbclr    T1IE
00000d   efe0     jbset   0x1e0, 0x7               jbset    T1IF
00000e   a015     goto    0x15                     goto    just_int0        
                                           ;*********timer1***********
00000f   dfe0     bclr    0x1e0, 0x7               bclr    T1IF
                                                   ;movai   0x3c
                                                   ;movra   TBCR
000010   f9c8     jbclr   0x1c8, 0x4               jbclr       P1,4
000011   a014     goto    0x14                     goto        lab_p01_4
000012   c9c8     bset    0x1c8, 0x4               bset        P1,4
000013   a015     goto    0x15                     goto        end_time1_interrupt
                                           lab_p01_4:    
000014   d9c8     bclr    0x1c8, 0x4               bclr        P1,4
                                           
                                           
                                           end_time1_interrupt:
                                           ;**********end_timer1******
                                           just_int0:
000015   f5ba     jbclr   0x1ba, 0x2           jbclr    INT0IE
000016   e5bb     jbset   0x1bb, 0x2           jbset    INT0IF
000017   a01d     goto    0x1d                 goto     just_int1
                                           ;**********int0************
000018   d5bb     bclr    0x1bb, 0x2           bclr    INT0IF
                                               
                                           
                                               
                                               ;goto	end_time1_interrupt
                                           end_int0_interrupt:
                                           just_kbim:
000019   ffba     jbclr   0x1ba, 0x7               jbclr KBIE
00001a   efbb     jbset   0x1bb, 0x7               jbset   KBIF
00001b   a01d     goto    0x1d                     goto    just_int1
00001c   dfbb     bclr    0x1bb, 0x7               bclr    KBIF
                                           ;*********end int0*********
                                           just_int1:
00001d   f7ba     jbclr   0x1ba, 0x3           jbclr    INT1IE
00001e   e7bb     jbset   0x1bb, 0x3           jbset    INT1IF
00001f   a021     goto    0x21                 goto     end_just_int
                                           ;**********int0************
000020   d7bb     bclr    0x1bb, 0x3           bclr    INT1IF
                                           
                                           ;**********end_kbim********
                                           end_just_int:
                                           exit_interrupt:
                                           
000021   000d     retie                        retie     
                                            
                                               
                                           ;***************************************
                                           main:
000022   000e     clrwdt                       clrwdt
                                            ;   bset    WDTEN
000023   dfb8     bclr    0x1b8, 0x7           bclr    GIE    ;开全局中断
                                           ;************main loop***************
                                           main_loop:
000024   000e     clrwdt                       clrwdt
000025   3c87     movai   0x87                 movai	0x87
000026   57e6     movra   0x1e6                movra	DKW	
                                           
                                           ;*******************************
                                           ;*****按键值保存在key_value*****
                                           ;**T扫 P00-P16-P10-P27-P20 16个IO
                                           key_deal:
000027   3cff     movai   0xff                 movai	0xff
000028   57c6     movra   0x1c6                movra	DKWP0
000029   57ce     movra   0x1ce                movra	DKWP1
00002a   57d6     movra   0x1d6                movra	DKWP2
                                           
00002b   c3bc     bset    0x1bc, 0x1           bset	LFEN
                                               
                                               ;timer1
00002c   3c64     movai   0x64                 movai       100
00002d   57e2     movra   0x1e2                movra       TBLOAD
00002e   3c24     movai   0x24                 movai       0x24
00002f   57e0     movra   0x1e0                movra       TBCR
                                               
000030   cfba     bset    0x1ba, 0x7           bset KBIE
000031   c006     bset    0x6, 0               bset        stop_enable
                                               
000032   000b     stop                         stop	
000033   3cff     movai   0xff                 movai   0xff
000034   57c9     movra   0x1c9                movra   DDR1
000035   dfba     bclr    0x1ba, 0x7           bclr    KBIE
000036   77ce     clrr    0x1ce                clrr    DKWP1
000037   cfb8     bset    0x1b8, 0x7           bset GIE
000038   cbe0     bset    0x1e0, 0x5           bset    TBCR,5
000039   c5e0     bset    0x1e0, 0x2           bset    TBCR,2
                                           
                                           loop:
                                                   
                                               ;call    keyscan
00003a   f3d0     jbclr   0x1d0, 0x1               jbclr   key
00003b   a022     goto    0x22                     goto    main
                                           
                                           
00003c   a03a     goto    0x3a                     goto loop
                                                   
                                           ;keyscan:
                                           ;        jbclr   key; P2,1 ;
                                           ;        goto    end_keyscan
                                           ;        call    delay10ms
                                           ;        call    delay10ms
                                           ;        call    delay10ms
                                           ;        jbclr   key; P2,1
                                           ;        goto    end_keyscan
                                           ;
                                           ;        jbclr       stop_enable
                                           ;        goto        lab_p00_0
                                           ;        bset        stop_enable
                                           ;        bclr        clk_enable
                                           ;        goto        cancle_end_keyscan
                                           ;lab_p00_0:    
                                           ;        bclr        stop_enable
                                           ;        bset        clk_enable        
                                           ;                                
                                           ;cancle_end_keyscan:
                                           ;        jbset   key;P1,6 
                                           ;        goto    cancle_end_keyscan
                                           ;        call    delay10ms
                                           ;        ;call    delay10ms
                                           ;        call    delay10ms
                                           ;        jbset   key;P1,6
                                           ;        goto    cancle_end_keyscan
                                           ;end_keyscan:        
                                           ;        return
                                           ;
                                           ;delay10ms:
                                           ;        movai   0xff
                                           ;        movra   r1
                                           ;re_load:
                                           ;        movai   0xff        
                                           ;        movra   r0
                                           ;del_dec:        
                                           ;        djzr    r0
                                           ;        goto    del_dec
                                           ;        djzr    r1
                                           ;        goto    re_load
                                           ;        nop
                                           ;        return         
                                           
                                           
                                           
                                               end


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XX-------------- XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXX------

All other memory blocks unused.

Program Memory Words Used:    54

